---
title: "The Mexican Peso"
subtitle: "Should We Praise A Strong Peso?"
date: "Nov 19th, 2024"
author: "Kevin Valdivia"
format: html
toc: false # Table of contents
execute: 
  warning: false
  message: false
  eval: false
---

```{r}
library(tidyverse)
library(lubridate)
```

```{r}
exchange <- read.csv("exrate.csv") |> 
  mutate(FIX = as.numeric(FIX)) |> 
  filter(!is.na(FIX)) |> 
  select(exchange = FIX, date = Date) |> 
  mutate(date = mdy(date))

```

```{r}
exchange |> 
  ggplot(aes(x = date, y = exchange)) +
  geom_rect(
    aes( xmin = as.Date("2014-08-01"), xmax = as.Date("2017-03-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("1994-01-01"), xmax = as.Date("1996-01-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("1994-01-01"), xmax = as.Date("1996-01-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("2008-01-01"), xmax = as.Date("2009-07-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("2020-01-01"), xmax = as.Date("2021-01-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("2024-05-01"), xmax = as.Date("2024-11-22"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_line() +  
  labs( x = "Date",
        y = "Exchange Rate",
        title = "Exchange Rate Over Time (2010-2024)") +
  scale_x_date(
    breaks = seq(from = min(peso_dlr$date), 
                 to = max(peso_dlr$date), 
                 by = "1 year"),
    labels = scales::date_format("%Y")) +
  scale_y_continuous(breaks = seq(1, 25, by = 1)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```





```{r}
library(ggplot2)
library(plotly)

# Data example (replace with your actual data)
peso_dlr <- data.frame(
  date = seq(as.Date("1990-01-01"), as.Date("2024-11-22"), by = "months"),
  exchange = cumsum(rnorm(419, mean = 0.1, sd = 0.5)) + 10
)

# Define red periods with annotations
red_periods <- data.frame(
  start = as.Date(c("1994-01-01", "2008-01-01", "2014-08-01", "2020-01-01", "2024-05-01")),
  end = as.Date(c("1996-01-01", "2009-07-01", "2017-03-01", "2021-01-01", "2024-11-22")),
  label = c("Tequila Crisis", 
            "Global Financial Crisis", 
            "NAFTA Renegotiation Concerns and US Election", 
            "COVID-19 Pandemic", 
            "US Presidential Election Year")
)

# Create the ggplot
p <- ggplot(peso_dlr, aes(x = date, y = exchange)) +
  geom_line(color = "blue", size = 1) +
  geom_rect(data = red_periods, aes(
    xmin = start, xmax = end, ymin = -Inf, ymax = Inf),
    fill = "red", alpha = 0.1, inherit.aes = FALSE
  ) +
  geom_text(data = red_periods, aes(
    x = (start + end) / 2, y = max(peso_dlr$exchange), label = label),
    color = "darkred", size = 3, angle = 45, inherit.aes = FALSE
  ) +
  labs(
    title = "Exchange Rate Over Time (1990-2024)",
    x = "Date",
    y = "Exchange Rate (MXN/USD)"
  ) +
  scale_x_date(date_breaks = "2 years", date_labels = "%Y") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Convert to plotly for interactivity
interactive_plot <- ggplotly(p)

# Display the interactive plot
interactive_plot

```



```{r}
exchange |> 
  ggplot(aes(x = date, y = exchange)) +
  geom_rect(
    aes( xmin = as.Date("2014-08-01"), xmax = as.Date("2017-03-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("1994-01-01"), xmax = as.Date("1996-01-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("1994-01-01"), xmax = as.Date("1996-01-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("2008-01-01"), xmax = as.Date("2009-07-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("2020-01-01"), xmax = as.Date("2021-01-01"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_rect(
  aes( xmin = as.Date("2024-05-01"), xmax = as.Date("2024-11-22"),
         ymin = -Inf, ymax = Inf),
         fill = "red", alpha = 0.002) +
  geom_line() +  
  labs( x = "Date",
        y = "Exchange Rate",
        title = "Exchange Rate Over Time (2010-2024)") +
  scale_x_date(
    breaks = seq(from = min(peso_dlr$date), 
                 to = max(peso_dlr$date), 
                 by = "1 year"),
    labels = scales::date_format("%Y")) +
  scale_y_continuous(breaks = seq(1, 25, by = 1)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```











```{r}
peso_dlr <- read.csv("peso_dlr.csv") |> 
  rename("date" = "DATE",
         "exchange_rate" = "DEXMXUS") |> 
  mutate(exchange_rate = as.numeric(exchange_rate),
         date = ymd(date))

inflation <- read.csv("inflation_data.csv") |> 
  mutate(date = ymd(paste0(period, "/01"))) |> 
  filter(!is.na(date)) |> 
  select(-period)

merge <- merge(peso_dlr, inflation, by = "date")
```

```{r}

peso_dlr |> 
  filter(date > as.Date("2010-01-01")) |> 
  ggplot(aes(x = date, y = exchange_rate)) +
  geom_rect(
    aes(
      xmin = as.Date("2014-08-01"), xmax = as.Date("2017-03-01"),
      ymin = -Inf, ymax = Inf  # This will cover the full range of the y-axis
    ),
    fill = "red", alpha = 0.002  # Adjust alpha for better visibility
  ) +
  geom_line() +  # Add line plot for exchange rates
  labs(
    x = "Date",
    y = "Exchange Rate",
    title = "Exchange Rate Over Time (2010-2024)"
  ) +
  scale_x_date(
    breaks = seq(from = min(peso_dlr$date), to = max(peso_dlr$date), by = "1 year"),
    labels = scales::date_format("%Y")  # Display years only
  ) +
  scale_y_continuous(
    breaks = seq(5, 25, by = 1)  # Adjust y-axis ticks
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)  # Tilt x-axis labels 45 degrees
  )

```




```{r}
inflation |> 
  ggplot(aes(date, inflation)) +
  geom_line() +
  labs(x = "Date",
       y = "Inflation") +
  theme_minimal()
```


